# -*- coding: utf-8 -*-
"""ibm_code.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KBJpACe4q-Bl5KCAZQowNjXO7etqKmJ_
"""

import pandas as pd
from statsmodels.tsa.holtwinters import ExponentialSmoothing
import matplotlib.pyplot as plt

df = pd.read_excel('gold_prices_final.xlsx')

df['Date'] = pd.to_datetime(df['Date'], errors='coerce')

df = df.dropna(subset=['Date'])

df = df.sort_values('Date')
df.set_index('Date', inplace=True)

gold_prices = df['Close-Last']

model = ExponentialSmoothing(gold_prices, trend='add', seasonal='mul', seasonal_periods=365)
hw_fit = model.fit()

plt.figure(figsize=(10,6))
plt.plot(gold_prices, label='Actual Gold Prices')
plt.plot(hw_fit.fittedvalues, label='Fitted Values', color='red')
plt.title('Holt-Winters Model Fitting on Gold Prices')
plt.legend()
plt.show()

def predict_future_dates(future_dates):
    last_date = gold_prices.index[-1]
    future_dates = pd.to_datetime(future_dates)

    days_ahead = (future_dates - last_date).days

    future_predictions = hw_fit.forecast(steps=max(days_ahead))

    return future_predictions.loc[future_dates]

example_future_dates = ['2023-10-01', '2023-12-01', '2024-01-01']
predicted_prices = predict_future_dates(example_future_dates)
print(predicted_prices)

